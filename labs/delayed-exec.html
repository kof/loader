<!DOCTYPE html>
<head>
    <title>loader demo</title>
    
<script type="text/javascript">


var url = 'http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js';

var head = document.getElementsByTagName("head")[0] || document.documentElement;

function loadScript(url) {
    console.time('load script');
    var script = document.createElement('script'),
        done = false;
    script.src = url;
    script.charset = 'UTF-8';
    script.onload = script.onreadystatechange = function() {
        if ( !done && (!this.readyState || /loaded|complete/.test(this.readyState) ) ) {
            done = true;
            console.timeEnd('load script');
        }
    };
    head.appendChild( script ); 
};

function jQueryExec() {
    console.time('eval jQuery');
    var m = window.jQueryModule+'';
    
    var first = m.indexOf('{')+1,
        last = m.lastIndexOf('}')-1,
        length = m.length - first - (m.length - last);
    m = m.substr(first, length);
    m = 'try{' + m + '}catch(e){ console.log(e) };';
    globalEval(m);
    //eval(m);
    console.timeEnd('eval jQuery');
}

function uiExec() {
    window.jQueryModule();
}

function globalEval( data ) {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.text = data;
    head.insertBefore( script, head.firstChild );
    head.removeChild( script );
}


</script>


    

</head>
<body>

<button onclick="loadScript('jquery-delayed.js')">Load jQuery</button>
<button onclick="loadScript('jquery.ui.core-delayed.js')">Load ui</button>
<button onclick="jQueryExec()">Exec jQuery</button>
<button onclick="uiExec()">Exec UI</button>
<button onclick="alert(window.jQuery)">Check jQuery</button>
</html>
